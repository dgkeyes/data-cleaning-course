<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Regular Expressions</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/tachyons-4.12.0/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset-0.2.4/panelset.css" rel="stylesheet" />
    <script src="libs/panelset-0.2.4/panelset.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Regular Expressions

---





layout: true
  
&lt;div class="dk-footer"&gt;
&lt;span&gt;
&lt;a href="https://rfortherestofus.com/" target="_blank"&gt;R for the Rest of Us
&lt;/a&gt;
&lt;/span&gt;
&lt;/div&gt; 

---









class: center, middle, dk-section-title
background-image:url("images/alex-iby-2JfOIZ1jR3M-unsplash.jpg")
background-size: cover
# What are Regular Expressions?

---

class: middle

## Specially encoded _strings_ of characters that match patterns in other text strings 

---
class: center, middle, dk-section-title
background-image:url("images/dylan-freedom-DLwjgBvD_yA-unsplash.jpg")
background-size: cover
## Strings

---

### Strings

A collection of characters that make up one element of a vector:

```r
test_string &lt;- "This sentence is a string."
```

--

We can store multiple strings in a character vector:


```r
pets &lt;-  c("dog","cat","parrot")
```

---

### Strings

.pull-left[
Headers and values in a data frame can also be strings:]



.pull-right[

```{=html}
&lt;style&gt;html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xoyreymxuy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xoyreymxuy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xoyreymxuy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xoyreymxuy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xoyreymxuy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xoyreymxuy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xoyreymxuy .gt_col_heading {
  color: #333333;
  background-color: yellow;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xoyreymxuy .gt_column_spanner_outer {
  color: #333333;
  background-color: yellow;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xoyreymxuy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xoyreymxuy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xoyreymxuy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xoyreymxuy .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xoyreymxuy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xoyreymxuy .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#xoyreymxuy .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#xoyreymxuy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xoyreymxuy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#xoyreymxuy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xoyreymxuy .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#xoyreymxuy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xoyreymxuy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xoyreymxuy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xoyreymxuy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xoyreymxuy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xoyreymxuy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#xoyreymxuy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xoyreymxuy .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#xoyreymxuy .gt_left {
  text-align: left;
}

#xoyreymxuy .gt_center {
  text-align: center;
}

#xoyreymxuy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xoyreymxuy .gt_font_normal {
  font-weight: normal;
}

#xoyreymxuy .gt_font_bold {
  font-weight: bold;
}

#xoyreymxuy .gt_font_italic {
  font-style: italic;
}

#xoyreymxuy .gt_super {
  font-size: 65%;
}

#xoyreymxuy .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
&lt;/style&gt;
&lt;div id="xoyreymxuy" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;&lt;table class="gt_table"&gt;
  
  &lt;thead class="gt_col_headings"&gt;
    &lt;tr&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"&gt;drink&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1"&gt;price&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left" style="background-color: #FFFF00;"&gt;Coffee&lt;/td&gt;
      &lt;td class="gt_row gt_right"&gt;3.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left" style="background-color: #FFFF00;"&gt;Tea&lt;/td&gt;
      &lt;td class="gt_row gt_right"&gt;2.99&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left" style="background-color: #FFFF00;"&gt;Juice&lt;/td&gt;
      &lt;td class="gt_row gt_right"&gt;3.20&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;&lt;/div&gt;
```
]

---

### Strings in R are _case sensitive_

Uppercase and lowercase letters are treated as distinct



```r
"cat"=="cat"
```

```
## [1] TRUE
```

--


```r
"cat"=="CAT"
```

```
## [1] FALSE
```


---

### Regex searches are case sensitive by default

So we can:    

--

- Build case-insensitive regular expressions  

--

- Change the matching to be case insensitive  

--

- Coerce the input before matching

---

class: center, middle, dk-section-title
background-image:url("images/jorge-balleza-vtvwNNjYBz4-unsplash.jpg")
background-size: cover
## Why Learn Regular Expressions?

---

class: center, middle

.xl[🕰]

.large[Cleaning text can be **time-consuming** and the first hurdle to address when working with less-than-perfect data.]

---

class: center, middle

.xl[💻]

.large[      
Regular expressions can often **replace dozens of lines of code.**] 

--

.large[
Regex is **not specific to any particular programming language or command-line tool.**]

---

class: center, middle, dk-section-title
background-image:url("images/dan-gold-4YAhiaZkUfs-unsplash.jpg")
background-size: cover
# Literal Characters and Metacharacters

---

## Getting started
To search for a specific sequence of characters, the regexp (regular expression) we need is simply that sequence of characters.

.fl.w-third[
&lt;div class="f2 mt1 pt0 code"&gt;Regexp&lt;/div&gt;
&lt;/br&gt;
`dog`
]

.fl.w-third[
&lt;div class="f2 mt0 pt0 code"&gt;Input string&lt;/div&gt;
&lt;/br&gt;
"The dog is fat."
]

.fl.w-third[
&lt;div class="f2 mt0 pt0 code"&gt;Match&lt;/div&gt;
&lt;/br&gt;
The .bg-yellow[dog] is fat.

]

---

## Literal characters

We will get a match whenever the characters .orange[`d`], .orange[`o`], and .orange[`g`] occur consecutively in the input text.

--

`"dog"` tells the regex engine:
find a .orange[d], immediately followed by an .orange[o], immediately followed by a .orange[g] (together and in that particular order)

---

## Literal characters (continued)

.orange[`d`], .orange[`o`], and .orange[`g`] are examples of literal characters.

--

They stand for exactly what they are: .orange[`d`] in the regex matches a “.purple.b[d]” in the input text, .orange[`o`]  matches an “.purple.b[o]” in text, and so on.

---

## Metacharacters
  
The power and flexibility of regular expressions comes from their ability to describe more complex patterns.

--

If a text pattern can be described verbally, we can most likely write regular expression to match it.

---

### Possible patterns

- "dog" but not "dogs"  

--

- "dogs" but only if string begins with "dogs"  

--

- digits (0,1,2,3,4,5,6,7,8,9)  

--

- "modeling" or "modelling"  

--

- words ending in "at"

--

- strings that start with digits

--

- dates



---

### Possible patterns


- zip codes

--

- numbers inside square brackets and also the brackets  

--

- valid Twitter handles (start with @, no spaces or symbols, &lt;16 characters)

--

- UPPERCASE words

--

- positions at which strings switch letter case (e.g. lowerUPPER)


---

## Metacharacters
To match more than literal strings of text, we call on a small subset of characters that have special functionalities when they appear in a regular expression.

--
 
Metacharacters include: .b.orange[[]\^$.|?*+()], which are reserved for unique matching purposes.

---

### Using metacharacters

Most metacharacters fall into major "families"

--

.b[Wildcards] stand in for unknown characters  
&amp;nbsp; .f1.orange.pre[&amp;nbsp;.&amp;nbsp; ] &amp;nbsp;&amp;nbsp; match any character

--

.b[Character sets/classes] match one or more characters  
&amp;nbsp;.b.orange.pre[&amp;nbsp;[ ] &amp;nbsp;] &amp;nbsp;&amp;nbsp; match a set of characters

--

.b[Anchors] specify te relative position of the pattern being matched   
&amp;nbsp;.orange.large.pre[&amp;nbsp;^&amp;nbsp;] &amp;nbsp;&amp;nbsp;     starts with
&amp;nbsp;.large.orange.pre[&amp;nbsp;$&amp;nbsp;]  &amp;nbsp;&amp;nbsp; ends with

---

### Using metacharacters (continued)

**Quantifiers** specify how many times a character or character class must appear in the input for a match to be found

&amp;nbsp;.f2[.orange.f1[&amp;nbsp;?&amp;nbsp;] &amp;nbsp;&amp;nbsp;Zero or one (of the preceding character)]  	
&amp;nbsp;.f2[.orange.f1[&amp;nbsp;\\\*&amp;nbsp;] &amp;nbsp;&amp;nbsp;Zero or more occurrences] 	
&amp;nbsp;.f2[.orange.f1[&amp;nbsp;+&amp;nbsp;]	 &amp;nbsp;&amp;nbsp;One or more occurrences]   
&amp;nbsp;.f2[.orange.f1[&amp;nbsp;{}] 	&amp;nbsp;&amp;nbsp;Exactly the specified number of occurrences]  	

---

### Using metacharacters (continued)

.b[Negation tokens]&amp;nbsp;&lt;br&gt;
.orange.b[[^]] 	&amp;nbsp;&amp;nbsp; matches characters not in the specified character set

.b[Alternation] tokens separate a series of alternatives&lt;br&gt;
.orange.b.pre[&amp;nbsp;|&amp;nbsp;] &amp;nbsp;&amp;nbsp; either or

.b[Special sequences and escapes]&lt;br&gt;
.b.orange.pre[&amp;nbsp;\\&amp;nbsp;] 	&amp;nbsp;&amp;nbsp; signals a shorthand sequence or gives special characters a literal meaning

---

### Note 

* To use special characters in a regular expression, escape them with a backslash, but the backslash itself needs to be escaped.

* Metacharacters inside a character set are stripped of their special nature.

---

### Using metacharacters (continued)

.b[Shorthand character classes] are available to refer to commonly-used character sets

.b.orange[\w] &amp;nbsp;all letters and numbers   &lt;br&gt;
.b.orange[\d] &amp;nbsp;digits&lt;br&gt;
.orange.b[\t]  &amp;nbsp;tab &lt;br&gt;
.orange.b[\n]  &amp;nbsp;new line&lt;br&gt;
.orange.b[\s]  &amp;nbsp;space&lt;br&gt;
.orange.b[\b]  &amp;nbsp;word boundary&lt;br&gt;

---

### Using metacharacters (continued)

.b[Shorthand + negation]  

.orange.b[\S]  &amp;nbsp;  not whitespace&lt;br&gt;
.orange.b[\D]  &amp;nbsp;  not digits&lt;br&gt;
.orange.b[\W]  &amp;nbsp;not letters, numbers, or underscores&lt;br&gt;

---

### Examples

.b.orange[\\\\\\\\(hello\\\\\\\\)] matches .b["(hello)"]  

--

.b.orange[ing$] matches .b["going"] but not .b["ingest"]  

--

.b.orange[f..l] matches **"fill"**, **"fool"**, but not **"flail"**  

--

.b.orange[dog|bird] matches **"dog"** or **"bird"**

--

.b.orange[[cb]at] matches **"cat"**, and **"bat"**, but not   **"rat"**

---

### Examples (continued)

.b.orange[modell?ing] matches .b["modeling"] and .b["modelling"]  

--

.b.orange[ya*y!] matches .b["yy"], .b["yay!"], .b["yaaay!"], .b[“yaaaaaay!”], etc.  

--

.b.orange[no+] matches .b[“no”], **“noo"**, **“nooooo”**, etc, but not **“n”**  
 
--

.b.orange[^can.\\\*] matches **"can"**, **"canine"**, **"canoli"**, **"canadian"**

---

### Examples (continued)

.b.orange[\\bcase] matches .b["case"] and .b["casein"] but not .b["suitcase"]  

--

.b.orange[\\s{3}] matches three spaces 

--

.b.orange[[^aoeio]] matches consonants
 
--

.b.orange[^[a-z]+$] matches a lowercase string

---

class: center, middle, dk-section-title
background-image:url("images/joakim-honkasalo-1LEq1hqDxEg-unsplash.jpg")
background-size: cover
# Regex in R

---

## Matching patterns with base R

**`grepl()`** - returns a logical vector (match or no match for each element of x)

--

`grepl(pattern, x)`

--


```r
grepl(pattern = "cat", x= c("catalog", "battlecat", "apple"))
```

```
## [1]  TRUE  TRUE FALSE
```

---

## Matching patterns with base R

**`grep()`** - returns a vector indicating which elements of x yielded a match  

--

`grep(pattern, x)`

--


```r
grep(pattern = "cat", x= c("catalog", "battlecat", "apple"))
```

```
## [1] 1 2
```


---

## Replacing matches with base R

**`gsub()`** - returns the input string with substitutions  

--

`gsub(pattern, replacement, x)`

--


Replacing matches (British to American spelling)

```r
gsub(pattern = "ou",
     replacement = "o",
     x= c("colour", "neighbour", "honour"))
```

```
## [1] "color"    "neighbor" "honor"
```


---

## 📦 .rrured[`stringr`]
.right[https://stringr.tidyverse.org/]


Cohesive set of functions for string manipulation

--

- Function names start with .b[`str_`]   

--

- All functions take a vector of strings as the first argument (pipe-friendly)  

--

**`regex()`** modifier to control matching behavior


---

## `stringr` examples

**Matches?**


```r
str_detect(string = c("catalog", "battlecat", "apple"), pattern = "cat")
```

```
## [1]  TRUE  TRUE FALSE
```

---

## `stringr` examples

**Which elements contain matches?**


```r
str_which(string = c("catalog", "battlecat", "apple"), pattern = "cat")
```

```
## [1] 1 2
```

---

## `stringr` examples

**Replacing matches (British to American spelling)**


```r
str_replace(string = c("colour", "neighbour", "honour"),
            pattern = "ou",
            replacement = "o")
```

```
## [1] "color"    "neighbor" "honor"
```

---

class: center, middle, dk-section-title
background-image:url("images/dfkt-nkynQWagL-s-unsplash.jpg")
background-size: cover
# Understanding a Regular Expression

---
  
## Online regex testers

- [regex101](https://regex101.com/) by Firas Dib 

--

- [regexr](https://regexr.com/) by Grant Skinner 

--

- [regexpal](https://www.regexpal.com/) - part of Dan's Developer Tools 


---

## Inside R 

- 📦 [`regexplain`](https://www.garrickadenbuie.com/project/regexplain/) by Garrick Aden‑Buie

--

- `str_view()` from 📦 [`stringr`](https://stringr.tidyverse.org/)]

---

class: my-turn
## My Turn

1. Write regular expressions for the patterns below  

--

2. Test them in an interactive tool

* "dogs" but only if string begins with "dogs"  
* strings that start with digits  
* UPPERCASE strings  
* numbers in brackets  
* strings that end in “at” but longer than 3 characters   

---

class: my-turn
## My Turn

Match the regular expressions against the following vector (clue: there is only one match for each pattern)


```r
test_vector &lt;- c("Those dogs are small.","dogs and cats",
                 "34","(34)","rat","watchdog","placemat",
                 "BABY","2011_April","HELP","mice")
```

---

class: inverse
## Your turn

Write regular expressions to match the following:

* cute, cuuute, cuuuuuute, and cuuuuuuuuute 
* strings with both letters and digits
* strings ending in a period
* lowercase strings
* exactly four digits
* strings without the letter _**s**_

---

class: center, middle, dk-section-title
background-image:url("images/patrick-janser-YGP2NAGaBwc-unsplash.jpg")
background-size: cover
# Regular Expressions and Data Cleaning

---

## Using regular expressions in data cleaning

--

Select, keep, or discard rows and columns

--
   
Substitute or recode values
 
--

Extract or remove substrings

---

## Cleaning data with regex

Most data wrangling workflows involve specifying columns (variables).

To select variables in 📦 .b.rrured[`dplyr`] and 📦 .b.rrured[`tidyr`]:

--

- write out their names   

--

- refer to them by position  

--

- specify ranges of contiguous variables

--

- use 📦 .b.rrured[`tidyselect`] helper functions

---

## 📦 .rrured.b[`tidyselect`] helpers


.b[`matches()`] takes regular expressions, and selects variables that match a given pattern

--

**`starts_with()`**: Starts with a prefix  

--

**`ends_with()`**: Ends with a suffix  

--

**`contains()`**: Contains a literal string 


---

### Selecting columns by name

`penguins` data from 📦 .rrured.b[`palmerpenguins`]


```r
names(penguins)
```

```
## [1] "species"           "island"            "bill_length_mm"   
## [4] "bill_depth_mm"     "flipper_length_mm" "body_mass_g"      
## [7] "sex"               "year"
```


```r
penguins %&gt;% select(species, bill_length_mm, flipper_length_mm) %&gt;% 
  sample_n(3)
```

```
## # A tibble: 3 x 3
##   species bill_length_mm flipper_length_mm
##   &lt;fct&gt;            &lt;dbl&gt;             &lt;int&gt;
## 1 Adelie            36                 187
## 2 Adelie            40.8               208
## 3 Gentoo            49.1               220
```
 
---

### Selecting columns by matches in variables names


```r
names(penguins)
```

```
## [1] "species"           "island"            "bill_length_mm"   
## [4] "bill_depth_mm"     "flipper_length_mm" "body_mass_g"      
## [7] "sex"               "year"
```


```r
penguins %&gt;% select(species, matches("length")) %&gt;% sample_n(3)
```

```
## # A tibble: 3 x 3
##   species bill_length_mm flipper_length_mm
##   &lt;fct&gt;            &lt;dbl&gt;             &lt;int&gt;
## 1 Adelie            43.1               197
## 2 Adelie            42                 190
## 3 Adelie            45.8               197
```

---

### Match values and filter rows

Mammals sleep dataset (`msleep`) from 📦 .rrured.b[`ggplot2`]


```r
library(ggplot2)
```


```r
msleep %&gt;% select(name,genus) %&gt;% sample_n(7)
```

```
## # A tibble: 7 x 2
##   name            genus        
##   &lt;chr&gt;           &lt;chr&gt;        
## 1 Rabbit          Oryctolagus  
## 2 Pilot whale     Globicephalus
## 3 Vesper mouse    Calomys      
## 4 Galago          Galago       
## 5 Desert hedgehog Paraechinus  
## 6 Musk shrew      Suncus       
## 7 Pig             Sus
```

---

### Match values and filter rows

Filter to keep rats only


```r
msleep %&gt;% select(name,genus) %&gt;% 
  filter(str_detect(string = name,pattern = "rat"))
```

```
## # A tibble: 5 x 2
##   name                      genus     
##   &lt;chr&gt;                     &lt;chr&gt;     
## 1 African giant pouched rat Cricetomys
## 2 Round-tailed muskrat      Neofiber  
## 3 Laboratory rat            Rattus    
## 4 Cotton rat                Sigmodon  
## 5 Mole rat                  Spalax
```

.dark-green[🐀 How can we exclude muskrats?]

---




## Substitute or recode values

.panelset[
.panel[.panel-name[companies]


```{=html}
&lt;style&gt;html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qtdrzdmhpr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qtdrzdmhpr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qtdrzdmhpr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qtdrzdmhpr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qtdrzdmhpr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtdrzdmhpr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qtdrzdmhpr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qtdrzdmhpr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qtdrzdmhpr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qtdrzdmhpr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qtdrzdmhpr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qtdrzdmhpr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qtdrzdmhpr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qtdrzdmhpr .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#qtdrzdmhpr .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#qtdrzdmhpr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qtdrzdmhpr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qtdrzdmhpr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtdrzdmhpr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qtdrzdmhpr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtdrzdmhpr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qtdrzdmhpr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qtdrzdmhpr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtdrzdmhpr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qtdrzdmhpr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qtdrzdmhpr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qtdrzdmhpr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qtdrzdmhpr .gt_left {
  text-align: left;
}

#qtdrzdmhpr .gt_center {
  text-align: center;
}

#qtdrzdmhpr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qtdrzdmhpr .gt_font_normal {
  font-weight: normal;
}

#qtdrzdmhpr .gt_font_bold {
  font-weight: bold;
}

#qtdrzdmhpr .gt_font_italic {
  font-style: italic;
}

#qtdrzdmhpr .gt_super {
  font-size: 65%;
}

#qtdrzdmhpr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
&lt;/style&gt;
&lt;div id="qtdrzdmhpr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;&lt;table class="gt_table"&gt;
  
  &lt;thead class="gt_col_headings"&gt;
    &lt;tr&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"&gt;Company&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"&gt;Operation&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Olsson&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;Logistics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Ollsson&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;Logistics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;olson&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;Logistics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Olsson LLC&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;Logistics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Olsson Group&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;Logistics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Olsonn&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;Logistics&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Mila Inc&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;E-commerce&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Mila Inc&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;E-commerce&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_left"&gt;Mila Inc&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;E-commerce&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;&lt;/div&gt;
```
]

.panel[.panel-name[Data setup]

```r
companies &lt;- data.frame(
  stringsAsFactors = FALSE,
           Company = c("Olsson","Ollsson","olson",
                       "Olsson LLC","Olsson Group","Olsonn","Mila Inc",
                       "Mila Inc","Mila Inc"),
         Operation = c("Logistics","Logistics",
                       "Logistics","Logistics","Logistics","Logistics",
                       "E-commerce","E-commerce","E-commerce")
)
```
]
]

---

### Substitute or recode values
.i[(correct name should be Olsson)]  

```r
companies %&gt;% 
  mutate(Company=str_replace(Company,"[o|O]l+s+on+.*","Olsson")) %&gt;% 
  distinct()
```

```
##    Company  Operation
## 1   Olsson  Logistics
## 2 Mila Inc E-commerce
```

---

## Case insensitive matching


```r
companies %&gt;%
  mutate(Company = str_replace(
    Company,
    regex("ol+s+on+.*", ignore_case = TRUE), "Olsson"
  )) %&gt;%
  distinct()
```

```
##    Company  Operation
## 1   Olsson  Logistics
## 2 Mila Inc E-commerce
```

---



## Extract or remove substrings  
.panelset[
.panel[.panel-name[team_record]

```{=html}
&lt;style&gt;html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#actorzgvsa .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#actorzgvsa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#actorzgvsa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#actorzgvsa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#actorzgvsa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#actorzgvsa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#actorzgvsa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#actorzgvsa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#actorzgvsa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#actorzgvsa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#actorzgvsa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#actorzgvsa .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#actorzgvsa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#actorzgvsa .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#actorzgvsa .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#actorzgvsa .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#actorzgvsa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#actorzgvsa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#actorzgvsa .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#actorzgvsa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#actorzgvsa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#actorzgvsa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#actorzgvsa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#actorzgvsa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#actorzgvsa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#actorzgvsa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#actorzgvsa .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#actorzgvsa .gt_left {
  text-align: left;
}

#actorzgvsa .gt_center {
  text-align: center;
}

#actorzgvsa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#actorzgvsa .gt_font_normal {
  font-weight: normal;
}

#actorzgvsa .gt_font_bold {
  font-weight: bold;
}

#actorzgvsa .gt_font_italic {
  font-style: italic;
}

#actorzgvsa .gt_super {
  font-size: 65%;
}

#actorzgvsa .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
&lt;/style&gt;
&lt;div id="actorzgvsa" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;&lt;table class="gt_table"&gt;
  
  &lt;thead class="gt_col_headings"&gt;
    &lt;tr&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1"&gt;week&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"&gt;result&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"&gt;game&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_center"&gt;12&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;loss&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;home&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_center"&gt;13&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;loss (disqualified)&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;away&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_center"&gt;14&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;win (overturned)&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;away&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_center"&gt;15&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;win (forefit)&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;home&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="gt_row gt_center"&gt;16&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;win (rematch)&lt;/td&gt;
      &lt;td class="gt_row gt_left"&gt;away&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;&lt;/div&gt;
```
]
.panel[.panel-name[Data setup]

```r
team_record &lt;- 
tibble::tribble(
  ~week,               ~result,  ~game,
    12L,                "loss", "home",
    13L, "loss (disqualified)", "away",
    14L,    "win (overturned)", "away",
    15L,       "win (forefit)", "home",
    16L,       "win (rematch)", "away"
  )
```
]
]

.b[`str_extract()`] extracts matching patterns  
.b[`str_remove()`]  removes matched patterns

---

### Extract substrings


```r
team_record %&gt;%
  mutate(result_comment = str_extract(
    string = result, pattern = "\\(.+\\)"))
```

```
## # A tibble: 5 x 4
##    week result              game  result_comment
##   &lt;int&gt; &lt;chr&gt;               &lt;chr&gt; &lt;chr&gt;         
## 1    12 loss                home  &lt;NA&gt;          
## 2    13 loss (disqualified) away  (disqualified)
## 3    14 win (overturned)    away  (overturned)  
## 4    15 win (forefit)       home  (forefit)     
## 5    16 win (rematch)       away  (rematch)
```


--

*Can we strip the brackets with a regular expression?*

---

### Extract substrings
.large.b[`str_remove_all()`]

```r
team_record %&gt;%
  mutate(result_comment = str_extract(
    string = result, pattern = "\\(.+\\)")) %&gt;% 
  mutate(result_comment=str_remove_all(result_comment,"[()]"))
```

```
## # A tibble: 5 x 4
##    week result              game  result_comment
##   &lt;int&gt; &lt;chr&gt;               &lt;chr&gt; &lt;chr&gt;         
## 1    12 loss                home  &lt;NA&gt;          
## 2    13 loss (disqualified) away  disqualified  
## 3    14 win (overturned)    away  overturned    
## 4    15 win (forefit)       home  forefit       
## 5    16 win (rematch)       away  rematch
```

---

### Remove substrings


```r
team_record %&gt;%
  mutate(result=str_remove(
    string= result,pattern = " \\(.*\\)"))
```

```
## # A tibble: 5 x 3
##    week result game 
##   &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;
## 1    12 loss   home 
## 2    13 loss   away 
## 3    14 win    away 
## 4    15 win    home 
## 5    16 win    away
```

---

class: my-turn
# My Turn

1. Download CRAN package descriptions  

--

2. Select Package name, author, description, and all variables that contain 'License'  

--

3. Filter rows for packages with names that:  

--

 - start with _gg_ (case insensitivty)
 
--
 
 - contain _Bayes_
 
--

 - contain _glm_ but not _glmm_

---
class: inverse
# Your Turn

1. Download CRAN package descriptions  

--

2. Select package name, author, description, and all variables that end in 'ports'  

--

3. Filter rows for packages with names that: 

--

 - end in _plot_

--

 - contain _Bayes_

--

 - contain digits  

--

 - are all UPPER CASE
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
